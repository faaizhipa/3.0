"use strict";cjce.registerTemplate("bm-p-photoswithwebapp",function(e,a){var s,c,l,o,t,r,_,i,n,d=!cjBasics.webRequest.getWrifSupported()||a.missingGooglePermission||!a.account.validSession,h=cjBasics.generateUniqueId(),m="https://photos.google.com",b=a.wizPath+"/",j={bm_cid:"photoswithwebapp",bm_iid:h,bm_wiz:"1",bm_cst:"1",bm_udm:a.darkMode?"1":"0",lfhs:"1",hl:cjBasics.lang.getCurrent()},p=m+b,u="",g=cjBasics.lang.i18n("cj_i18n_00291","Home"),v={photos:{iconName:"__mdi_todo:photo",label:cjBasics.lang.i18n("cj_i18n_00429","Photos"),newTabUrl:!0},explore:{iconName:"__mdi_todo:search",label:cjBasics.lang.i18n("cj_i18n_00061","Explore"),newTabUrl:!0},foryou:{iconName:"__mdi_todo:assistant",label:cjBasics.lang.i18n("cj_i18n_01055","For you"),newTabUrl:!0},printstore:{iconName:"__mdi_todo:shopping_bag",label:cjBasics.lang.i18n("cj_i18n_06612","Print store"),newTabUrl:!0,divider:!0},libraryHeader:{header:!0,label:cjBasics.lang.i18n("cj_i18n_00131","Library")},albums:{iconName:"__mdi_todo:photo_album",label:cjBasics.lang.i18n("cj_i18n_00400","Albums"),newTabUrl:!0},documents:{iconName:"__mdi_todo:draft",label:cjBasics.lang.i18n("cj_i18n_01777","Documents"),newTabUrl:!0},managelibrary:{iconName:"__mdi_todo:library_add_check",label:cjBasics.lang.i18n("cj_i18n_06596","Utilities"),newTabUrl:!0},archive:{iconName:"__mdi_todo:archive",label:cjBasics.lang.i18n("cj_i18n_00821","Archive"),newTabUrl:!0},lockedfolder:{iconName:"__mdi_todo:lock",label:cjBasics.lang.i18n("cj_i18n_07426","Locked folder"),newTabUrl:!0,external:!d},trash:{iconName:"__mdi_todo:delete",label:cjBasics.lang.i18n("cj_i18n_00005","Bin"),newTabUrl:!0,divider:!0},updates:{iconName:"__mdi_todo:notifications",label:cjBasics.lang.i18n("cj_i18n_00313","Updates"),newTabUrl:!0},settings:{iconName:"__mdi_todo:settings",label:cjBasics.lang.i18n("cj_i18n_00298","Settings"),newTabUrl:!0},apps:{iconName:"__mdi_todo:devices",label:cjBasics.lang.i18n("cj_i18n_01322","App downloads"),newTabUrl:!0},search:{label:cjBasics.lang.i18n("cj_i18n_00085","Search")},places:{iconName:"__mdi_todo:place",label:cjBasics.lang.i18n("cj_i18n_06563","Places"),newTabUrl:!0},things:{label:cjBasics.lang.i18n("cj_i18n_06586","Things")},unsaved:{label:cjBasics.lang.i18n("cj_i18n_06587","Unsaved")},photobooks:{label:cjBasics.lang.i18n("cj_i18n_00868","Photo books")},"search/_tv_":{label:cjBasics.lang.i18n("cj_i18n_00014","Videos")},"search/_m8_Favourites":{iconName:"__mdi_gm_hybrid:cjh_star",label:cjBasics.lang.i18n("cj_i18n_00692","Favourites"),newTabUrl:!0},"search/_m1_":{label:cjBasics.lang.i18n("cj_i18n_06588","360 Photos & Videos")},"search/_m3_":{label:cjBasics.lang.i18n("cj_i18n_06585","Motion photos")},"search/_m4_":{label:cjBasics.lang.i18n("cj_i18n_06584","Animations")},"search/_m5_":{label:cjBasics.lang.i18n("cj_i18n_00480","Movies")},"search/_m6_":{label:cjBasics.lang.i18n("cj_i18n_06589","Collages")},"search/_m7_":{label:cjBasics.lang.i18n("cj_i18n_06590","PhotoScan")},"search/_m8_":{label:cjBasics.lang.i18n("cj_i18n_00692","Favourites")},"search/_m9_":{label:cjBasics.lang.i18n("cj_i18n_01740","Archived")},"search/_m10_":{label:cjBasics.lang.i18n("cj_i18n_06591","Creations")},"search/_tra_":{label:cjBasics.lang.i18n("cj_i18n_06592","Recently added")},activities:{label:cjBasics.lang.i18n("cj_i18n_06593","Activity log")},unsupportedvideos:{label:cjBasics.lang.i18n("cj_i18n_06611","Unsupported videos")},people:{label:cjBasics.lang.i18n("cj_i18n_00295","People")}},B=["search/_tv_","search/_m1_","search/_m3_","search/_m4_","search/_m5_","search/_m6_","search/_m7_","search/_m8_","search/_m9_","search/_m10_","search/_tra_","search/_m8_Favourites"],f=["photos","updates","printstore","libraryHeader","albums","documents","search/_m8_Favourites","places","archive","lockedfolder","trash","managelibrary","settings","foryou"];function w(e){i.cjceSendFrameCommand({method:"bmCstClickDomElement",value:n[e]},m)}function C(){i.cjceSendFrameCommand({method:"bmCstNavigateBack"},m)}function S(e){a.openTab(p+e)}function T(e,a){S("home"===e?"":e)}function N(e){S("search/"+encodeURIComponent(e))}function U(){S("")}function k(e){e=cjBasics.urlParams.attach(b+("photos"!==e&&e?e:""),j);i.cjceSendFrameCommand({method:"bmCstUpdateState",value:e},m)}function A(e){var a=!(e=e.startsWith("activities/")?"activities":e)||"photos"===e,c=!0;if(e.startsWith("search"))for(var i=0;i<B.length;i++){var n=B[i];if(e.startsWith(n)){e=n,c=!1;break}}else"explore"!==e&&(c=!1);o.hidden=c,t.hidden=!(a&&"albums"!==e),r.hidden="albums"!==e,_.hidden="archive"!==e,s.cjceSetBackState(!a),l.hidden=!c,s.cjceSetNavigatorCollapseState(c),c?(l.focus(),setTimeout(function(){l.focus()},50),setTimeout(function(){l.focus()},500),l.value=u&&l.value===u?u:e.split("/")[1]||""):(u="",l.value="",a="home"===e||"photos"===e?g:v[e]&&v[e].label||e,s.cjceSetPageLabel(a))}d?(s=cjce.createElement("bm-ogb",{serviceIcon:"photos",serviceLabel:cjBasics.lang.i18n("cj_i18n_00429","Photos"),pageLabel:cjBasics.lang.i18n("cj_i18n_01167","Links"),searchbox:{submitInNewTab:!0,onSubmit:N},bmApis:a,onNewTab:U}),e.appendChild(s),a.setOnPageDisplayHandler(s.cjceSearchboxEl.select),d=cjce.createElement("cjmd-container",{scrollable:!0,shadow:"thinOnScroll"}),e.appendChild(d),c=cjce.createElement("bm-navlist",{items:f.map(function(e){return v[e]}),onClick:T,onNewTab:T}),d.appendChild(c)):(n={search:'path[d="M20.49 19l-5.73-5.73C15.53 12.2 16 10.91 16 9.5A6.5 6.5 0 1 0 9.5 16c1.41 0 2.7-.47 3.77-1.24L19 20.49 20.49 19zM5 9.5C5 7.01 7.01 5 9.5 5S14 7.01 14 9.5 11.99 14 9.5 14 5 11.99 5 9.5z"]',addToArchive:'path[d="M20 13h-7v7h-2v-7H4v-2h7V4h2v7h7v2z"], button[aria-label*="Add to archive"]',createAlbum:'path[d="M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V5h14v14zm-8-2h2v-4h4v-2h-4V7h-2v4H7v2h4z"], button[aria-label*="Create album"]',upload:'path[d="M4 15h2v3h12v-3h2v3c0 1.1-.9 2-2 2H6c-1.1 0-2-.9-2-2m4.41-7.59L11 7.83V16h2V7.83l2.59 2.59L17 9l-5-5-5 5 1.41 1.41z"],path[d="M4 15h2v3h12v-3h2v3c0 1.1-.9 2-2 2H6c-1.1 0-2-.9-2-2m4.41-7.59L11 7.83V16h2V7.83l2.59 2.59L17 9l-5-5-5 5 1.41 1.41z"]'},d=(s=cjce.createElement("bm-ogb",{loading:!0,drawer:!0,withShadow:!0,floating:!0,serviceIcon:"photos",serviceLabel:cjBasics.lang.i18n("cj_i18n_00429","Photos"),pageLabel:g,searchbox:{collapsable:!0,onSubmit:function(e){var a="search";e&&(a+="/"+encodeURIComponent(e)),k(a)},onMetaSubmit:N},bmApis:a,onNewTab:function(){i.cjceGetCleanUrl(m).then(function(e){e?a.openTab(e):U()})},onBack:C})).cjceDrawerEl,(l=s.cjceSearchboxEl).hidden=!0,a.setOnPageDisplayHandler(l.select),e.appendChild(s),(r=cjce.createElement("ccbm-iconbutton",{iconName:"__mdi_gm:add_box",label:cjBasics.lang.i18n("cj_i18n_06594","Create album"),onClick:function(){w("createAlbum")}})).hidden=!0,s.cjceAppendChild(r),(_=cjce.createElement("ccbm-iconbutton",{iconName:"__mdi_gm:add",label:cjBasics.lang.i18n("cj_i18n_06595","Add photos"),onClick:function(){w("addToArchive")}})).hidden=!0,s.cjceAppendChild(_),t=cjce.createElement("ccbm-iconbutton",{iconName:"__mdi_gm:file_upload",label:cjBasics.lang.i18n("cj_i18n_01326","Upload"),onClick:function(){w("upload")}}),s.cjceAppendChild(t),o=cjce.createElement("ccbm-iconbutton",{iconName:"__mdi_gm:search",label:cjBasics.lang.i18n("cj_i18n_00085","Search"),onClick:function(){k("explore"),w("search")}}),s.cjceAppendChild(o),c=cjce.createElement("bm-navlist",{isSelector:!0,selectedId:"photos",items:f.map(function(e){var a=v[e];return a.id=e,a}),onChange:function(e,a){k(e),A(e)},onNewTab:T}),d.appendChild(c),cjBasics.webRequest.handleIframeHeaders([m+"/*bm_iid="+h+"*"],{disableOgs:m,handleFirefoxInject:!0,handleSecVariables:!0,handleSwCache:!0}),cjBasics.webRequest.addListener("onBeforeSendHeaders",function(e){for(var a,c=e.requestHeaders,i=0;i<c.length;i++)"user-agent"===c[i].name.toLowerCase()&&(a=navigator.userAgent.split(" ").map(function(e){return e.startsWith("Chrome/")?"Chrome/10.0.3729.131":e}).join(" "),c[i].value=a);return{requestHeaders:c}},{urls:["https://photos.google.com/*bm_iid="+h+"*"],types:["sub_frame"]},["blocking","extraHeaders","requestHeaders"]),d=cjBasics.urlParams.attach(p,j),i=cjce.createElement("bm-iframe",{src:d,solid:!0,onBmMessage:function(e,a){"photoswithwebappUpdatePath"===e&&((a=v[e=a]||e.startsWith("search/")||e.startsWith("activities/"))&&A(e),c.cjceSelectedId=e,s.hidden=!a)},onLoad:function(){s.cjceSetLoading(!1)}}),e.appendChild(i))});