"use strict";function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var n;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(n="Object"===(n={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,c,a,o,r=[],s=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(i=a.call(n)).done)&&(r.push(i.value),r.length!==t);s=!0);}catch(e){l=!0,c=e}finally{try{if(!s&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw c}}return r}}function _arrayWithHoles(e){if(Array.isArray(e))return e}cjce.registerTemplate("bm-p-currentshybrid",function(t,i){var n,c,a,o,r,e,s,l,d,m,u,b,p,h,_,f,g,j,v,y,w=!cjBasics.webRequest.getWrifSupported()||!i.account.validSession,P="#1a73e8",T=cjBasics.lang.i18n("cj_i18n_01772","Currents"),C=i.wizPath+"/",S="https://currents.google.com",B="https://plus.google.com",O=B+C,U=S+C,R=U,D=U,L=i.account.obfuscatedId,A=!1,H=["stream","tags","communities","me","people","notifications","discover","collections","explore","settings"],W={stream:{label:cjBasics.lang.i18n("cj_i18n_00291","Home"),iconName:"__mdi_todo:home",newTabUrl:""},tags:{label:cjBasics.lang.i18n("cj_i18n_06609","Tags"),iconName:"__mdi_todo:tag",newTabUrl:"tags"},discover:{label:cjBasics.lang.i18n("cj_i18n_00926","Discover"),iconName:"__mdi_todo:explore",newTabUrl:"discover"},explore:{label:cjBasics.lang.i18n("cj_i18n_00485","Whatâ€™s hot"),iconName:"__mdi_todo:whatshot",newTabUrl:"explore",divider:!0},collections:{label:cjBasics.lang.i18n("cj_i18n_00292","Collections"),iconName:"__mdi_todo:google_collections",newTabUrl:"collections"},communities:{label:cjBasics.lang.i18n("cj_i18n_00293","Communities"),iconName:"__mdi_todo:communities",newTabUrl:"communities"},me:{label:cjBasics.lang.i18n("cj_i18n_00294","Profile"),iconName:"__mdi_todo:account_circle",newTabUrl:L},people:{label:cjBasics.lang.i18n("cj_i18n_00295","People"),iconName:"__mdi_todo:people",newTabUrl:"people"},notifications:{label:cjBasics.lang.i18n("cj_i18n_00296","Notifications"),iconName:"__mdi_todo:notifications",newTabUrl:"notifications/all",divider:!0},settings:{label:cjBasics.lang.i18n("cj_i18n_00298","Settings"),iconName:"__mdi_todo:settings",newTabUrl:"settings"},up:{label:cjBasics.lang.i18n("cj_i18n_06610","Join Currents"),iconName:"__mdi_todo:login",newTabUrl:"up"}};function k(e){return e.map(function(e){var t=W[e];return t.id=e,t})}function x(e){i.openTab(R+e)}function q(e,t){x(t.newTabUrl)}function z(e,t){var t=t.newTabUrl,n=("collections"===e||"communities"===e||"people"===e||"stream"===e)&&r.value;n&&(t="s/"+encodeURIComponent(n),"stream"!==e)&&(t+="/"+e),x(t)}function F(e){x("s/"+encodeURIComponent(e))}function G(){x("")}function I(){w=!0,t.textContent="",a=cjce.createElement("bm-ogb",{serviceIcon:"currents",serviceLabel:T,pageLabel:cjBasics.lang.i18n("cj_i18n_01167","Links"),searchbox:{color:P,submitInNewTab:!0,onSubmit:F},bmApis:i,onNewTab:G}),t.appendChild(a),r=a.cjceSearchboxEl,i.setOnPageDisplayHandler(r.select);var e=cjce.createElement("cjmd-container",{scrollable:!0,shadow:"thinOnScroll"});t.appendChild(e),m=k(H),o=cjce.createElement("bm-navlist",{color:!0,items:m,onClick:z,onNewTab:z}),e.appendChild(o)}function M(){l.cjceGetCleanUrl(S).then(function(e){e?i.openTab(e):x("back"===b?"":b)})}function J(e){var t=cjBasics.urlParams.attach(e,g),n=++f;_.then(function(){f===n&&l.cjceSendFrameCommand({method:"bmCstUpdateState",value:t})})}function N(e,t){var n=W[e];!t&&b===e||(b=e,J(C+n.newTabUrl),a.cjceSetPageLabel(n.label))}function V(){o=cjce.createElement("bm-navlist",{isSelector:!0,selectedId:b,items:m,onChange:function(e){N(e)},onNewTab:q}),e.textContent="",e.appendChild(o)}function $(){return cjBasics.urlParams.attach(D+(o&&(e=o.cjceSelectedId,"string"==typeof(e=W[e].newTabUrl))?e:""),g);var e}function K(e){!1===h&&(h=!0,p()),b="/"===(e=e)||"/stream"===e||"/stream/"===e?"stream":"/discover"===e||"/discover/"===e?"discover":e.startsWith("/settings")?"settings":e.startsWith("/people")||e.startsWith("/circles")?"people":e.startsWith("/notifications")?"notifications":e.startsWith("/tags")?"tags":"/me"===e||"/me/"===e||e==="/"+L||e==="/"+L+"/"||e==="/"+L+"/posts"||e==="/"+L+"/posts/"?"me":e.startsWith("/explore")?"explore":e.startsWith("/up")?"up":"/s"===e||e.startsWith("/s/")?"search":"/collections"===e||"/collections/"===e||e.startsWith("/collections/featured")||e.startsWith("/collections/followed")||e.startsWith("/collections/yours")?"collections":"/communities"===e||"/communities/"===e||e.startsWith("/communities/member")||e.startsWith("/communities/member/")||e.startsWith("/communities/yours")||e.startsWith("/communities/yours/")?"communities":"back",s.hidden="back"!==b,a.cjceSetBackState("search"===b),d.hidden=!A||!("stream"===b||"search"===b),"back"!==b&&(o.cjceSelectedId=b,W[b])&&a.cjceSetPageLabel(W[b].label)}function E(){r.value="",r.focus(),a.cjceSetNavigatorCollapseState(!1),N(u,!0)}function Q(){var e;n||(n=!0,m=k(["communities","notifications","collections","discover","explore","up"]),b=u="up",a.cjceSetPageLabel(W[b].label),V(),e=$(),l?l.src=e:_.then(function(){l.src=e}))}function X(e){c&&!e||(c=!0,I())}function Y(){cjgApis.info.getUserDomain(i.account).then(function(e){e||X()}),(i.account.validSession?cjBasics.ajax(O).then(function(e){return e||""},function(e){return e&&e.body||""}).then(function(e){return-1!==e.indexOf("Join Google+")||-1!==e.indexOf('rel="canonical" href="https://plus.google.com/discover')?"disabled":-1!==e.indexOf("<title>Google</title>")?"disabledAdministrator":"enabled"}):Promise.resolve("invalidSession")).then(function(e){!0!==e&&("disabled"===e||"invalidSession"===e?Q():"disabledAdministrator"===e&&X(!0))})}w?I():(w=!0,setTimeout(function(){w&&!c&&I()},4e3),m=k(H),b=u="stream",h=!1,_=new Promise(function(e){p=e}),f=0,j=cjBasics.generateUniqueId(),g={bm_cid:"currentshybrid",bm_cst:"2",bm_wiz:"1",bm_iid:j,hl:cjBasics.lang.getCurrent()},cjBasics.webRequest.handleIframeHeaders([S+"/*bm_iid="+j+"*",B+"/*bm_iid="+j+"*"],{handleFirefoxInject:!0}),Y(),j=cjce.createElement("cjmd-container"),y=$(),l=cjce.createElement("bm-iframe",{src:y,solid:"#fff",onLoad:function(){a.cjceSetLoading(!1)},onBmMessage:function(e,t){var n;"currentshybridWebsiteOrigin"===e?(w=!1,t===B&&(D=t+C)):"currentshybridPageTitle"===e?"back"===b&&s.cjceSetPageLabel(t):"currentshybridUpdateView"===e?K(t):"currentshybridWorkspaceLimit"===e?(d.cjceChecked=t,A||(A=!0,"stream"!==b&&"search"!==b)||(d.hidden=!1)):"bmCstOpenUrl"===e&&(t=(e=_slicedToArray(t,3))[0],n=e[1],e=e[2],t=cjBasics.cleanBmUrl(t),i.openTab(t,n,e))}}),v=cjBasics.webRequest.addListener("onBeforeRedirect",function(e){e.redirectUrl.startsWith(U+"up")&&(Q(),v.removeListener(),v=null)},{types:["sub_frame"],urls:[y]}),j.appendChild(l),y=j,a=cjce.createElement("bm-ogb",{drawer:{color:!0},loading:!0,serviceIcon:"currents",serviceLabel:T,pageLabel:W[b].label,searchbox:{color:P,onClear:E,onSubmit:function(e){J("s/"+encodeURIComponent(e))},onMetaSubmit:F},bmApis:i,onNewTab:M,onBack:E}),t.appendChild(a),e=a.cjceDrawerEl,r=a.cjceSearchboxEl,(d=cjce.createElement("ccbm-switch",{compact:!0,icon:"__mdi_todo:business",onChange:function(){a.cjceSetLoading(!0),l.cjceSendFrameCommand({method:"bmCstClickDomElement",value:'c-wiz > div[data-checked-veid][data-unchecked-veid][jslog][role="checkbox"][title][aria-checked][aria-label]'},S)}})).hidden=!0,a.cjceAppendChild(d),(s=cjce.createElement("bm-ogb",{displayBack:!0,floating:!0,serviceLabel:T,pageLabel:cjBasics.lang.i18n("cj_i18n_01174","Loading"),bmApis:i,onNewTab:M,onBack:E})).hidden=!0,t.appendChild(s),V(),i.setOnPageDisplayHandler(r.select),t.appendChild(y),N(b))});