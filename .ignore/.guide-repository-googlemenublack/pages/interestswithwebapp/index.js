"use strict";function _slicedToArray(e,n){return _arrayWithHoles(e)||_iterableToArrayLimit(e,n)||_unsupportedIterableToArray(e,n)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,n){var t;if(e)return"string"==typeof e?_arrayLikeToArray(e,n):"Map"===(t="Object"===(t={}.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:t)||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,n):void 0}function _arrayLikeToArray(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=Array(n);t<n;t++)a[t]=e[t];return a}function _iterableToArrayLimit(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,i,c,l,o=[],r=!0,s=!1;try{if(c=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;r=!1}else for(;!(r=(a=c.call(t)).done)&&(o.push(a.value),o.length!==n);r=!0);}catch(e){s=!0,i=e}finally{try{if(!r&&null!=t.return&&(l=t.return(),Object(l)!==l))return}finally{if(s)throw i}}return o}}function _arrayWithHoles(e){if(Array.isArray(e))return e}cjce.registerTemplate("bm-p-interestswithwebapp",function(s,d){var e=cjBasics.generateUniqueId(),n="0"===d.account.authuser?null:d.account.authuser,a="https://www.google.com",t=a+"/interests/",i={bm_cid:"interestswithwebapp",bm_iid:e,bm_cst:"1",bm_wiz:"1",authuser:n,pageId:d.account.pageId,hl:cjBasics.lang.getCurrent()},c=[],l=(n&&c.push("authuser="+n),d.account.pageId&&c.push("pageId="+d.account.pageId),0<c.length?"?"+c.join("&"):""),o="https://save-pa.googleapis.com/$rpc/google.search.platform.save.v2.SaveService/",m=!0,r=cjBasics.lang.i18n("cj_i18n_07396","Saved"),_={home:{iconName:"__mdi_gm_hybrid:cjh_bookmark",id:"home",label:r,shortcutId:"359"},liked:{iconName:"__mdi_gm_hybrid:cjh_favorite",id:"liked",label:cjBasics.lang.i18n("cj_i18n_07457","Liked")},followed:{iconName:"__mdi_gm_hybrid:saved_search",id:"followed",label:cjBasics.lang.i18n("cj_i18n_07458","Followed"),divider:!0},relatedHeader:{color:!0,header:!0,label:cjBasics.lang.i18n("cj_i18n_01539","Related apps")},search:{iconName:"__mdi_gm:search",label:cjBasics.lang.i18n("cj_i18n_01365","Google Search"),shortcutId:"157"},maps:{iconName:"__mdi_gm:place",label:cjBasics.lang.i18n("cj_i18n_01364","Google Maps"),shortcutId:"101"},shopping:{iconName:"__mdi_gm:local_offer",label:cjBasics.lang.i18n("cj_i18n_00059","Google Shopping"),shortcutId:"129"},destinations:{iconName:"__mdi_gm:explore",label:cjBasics.lang.i18n("cj_i18n_01774","Travel Guide"),shortcutId:"764"}};function u(e,n){var t="/interests/",e=("followed"===e||"liked"===e?t+=e:(t+="saved",e&&(t+="/list/"+encodeURIComponent(e))),cjBasics.urlParams.attach(t,i));n?k.src=a+e:k.cjceSendFrameCommand({method:"bmCstUpdateState",value:e},a)}var h=cjce.createElement("bm-ogb",{bmApis:d,drawer:!0,loading:!0,serviceIcon:"save",serviceLabel:cjBasics.lang.i18n("cj_i18n_07373","Interests"),pageLabel:r,onBack:function(){u(null)},onNewTab:function(){k.cjceGetCleanUrl(a).then(function(e){d.openTab(e||t+"saved"+l)})}}),b=(s.appendChild(h),h.cjceDrawerEl),p=cjce.createElement("bm-navlist",{selectedId:"home",items:_,onClick:function(e){"followed"===e||"liked"===e?u(e):"home"===e?u(null):d.pageManager.navigate(e)},onNewTab:function(e,n){n=n.newTabUrl||cjgFrontend.urls.getShortcutUrl(n.shortcutId,d.account);d.openTab(n)}}),j=(b.appendChild(p),!1),g=(A().then(function(e){var n;(j=0<e.length)&&(n=_,j&&(n=(n=[_.home,_.liked,_.followed,{color:!0,header:!0,label:cjBasics.lang.i18n("cj_i18n_07487","Saved collections")}]).concat(e)),p.remove(),p=cjce.createElement("bm-navlist",{isSelector:!0,selectedId:"home",items:n,onChange:function(e){u("home"===e?null:e)},onNewTab:function(e){d.openTab(t+("home"===e?"saved":"saved/list/"+e)+l)}}),b.appendChild(p))}),cjBasics.urlParams.attach(t+"saved",i));function f(e,n,t){n=n||{},n.alt="json",n.prettyPrint="false",e=cjBasics.urlParams.attach(o+e,n);return cjgApis.request(e,{method:"POST",fetchAs:"json",headers:{"Content-Type":"application/json+protobuf"},body:JSON.stringify(t||[])},{account:d.account,pa:!0,key:window.atob("QUl6YVN5QnMtR0pFRHFCQW4wTmlFdjAzbmtXZ0NVVHIydmxhVmww")})}cjBasics.webRequest.handleIframeHeaders([a+"/*bm_iid="+e+"*"],{handleFirefoxInject:!0,handleSecVariables:!0,handleSwCache:!0});var v={IMAGE:"__mdi_gm_hybrid:image",ITINERARY:"__mdi_gm_hybrid:assignment",JOB:"__mdi_gm_hybrid:work_outline",PLACE:"__mdi_gm_hybrid:place",RECIPE:"__mdi_gm_hybrid:restaurant",SCREENSHOT:"__mdi_gm_hybrid:photo",SHOPPING_PRODUCT:"__mdi_gm_hybrid:local_offer",TVM_ENTITY:"__mdi_gm_hybrid:play_circle_outline",WEB_PAGE:"__mdi_gm_hybrid:news"};function y(){return f("ListLists",{fields:"lists(listDescriptor(listId,itemTypes),displayName)",pageSize:"200"}).then(function(e){var a=[];return e.lists.forEach(function(e){var n=e.listDescriptor,t=n&&n.listId;t&&a.push({id:t,supportsAdditions:!Array.isArray(n.itemTypes)||-1!==n.itemTypes.indexOf("WEB_PAGE"),label:(t=(t=e.displayName)||"").charAt(0).toUpperCase()+t.slice(1),iconName:function(e){var n=e.listDescriptor&&e.listDescriptor.itemTypes;if(Array.isArray(n))for(var t=0;t<n.length;t++){var a=v[n[t]];if(a)return a}return"__mdi_gm_hybrid:cjh_bookmark"}(e),newTabUrl:!0})}),a.sort(function(e,n){var t=e.label.toLowerCase(),a=n.label.toLowerCase();return t===a?e.id>n.id?1:-1:a<t?1:-1}),a}).catch(function(){return[]})}function w(){return cjgApis.cache.getItem(d.account,"bm_cache_v36__collections__lists").then(function(e){return Array.isArray(e)?e:[]})}function I(e){return cjgApis.cache.setItem(d.account,"bm_cache_v36__collections__lists",e),e}var C=null;function A(){return C=C||y().then(I,w)}function B(e){var t=cjce.createElement("cjmd-container",{solid:!0,floating:!0}),n=cjce.createElement("bm-ogb",{bmApis:d,displayBack:!0,serviceIcon:"save",serviceLabel:cjBasics.lang.i18n("cj_i18n_07396","Saved"),pageLabel:cjBasics.lang.i18n("cj_i18n_06324","Save new item"),onBack:function(){t.remove()}}),a=(t.appendChild(n),cjce.createElement("cjmd-container",{scrollable:!0,shadow:"thinOnScroll"})),i=(t.appendChild(a),cjce.createElement("cjmd-card")),c=(i.classList.add("bm-p-interestswithwebapp-form"),a.appendChild(i),cjce.createElement("ccbm-textfield",{label:cjBasics.lang.i18n("cj_i18n_06316","Name")})),l=(i.appendChild(c),cjce.createElement("ccbm-textfield",{label:cjBasics.lang.i18n("cj_i18n_06317","Location (URL)")})),o=(i.appendChild(l),"_bm_choose_list"),r=(A().then(function(e){var n=[{value:"_bm_choose_list",label:cjBasics.lang.i18n("cj_i18n_06320","Add to collection")+"â€¦"}],t=(e.forEach(function(e){e.supportsAdditions&&n.push({value:e.id,label:e.label})}),cjce.createElement("ccbm-button--select",{outline:!0,items:n,selectedId:o,onChange:function(){o=t.cjceSelectedId}}));t.classList.add("bm-p-interestswithwebapp-form__selectbox"),i.appendChild(t)}),cjce.createElement("ccbm-button",{color:!0,fill:!0,label:cjBasics.lang.i18n("cj_i18n_01363","Save"),onClick:function(){var e,n;h.cjceSetLoading(!0),r.disabled=!0,r.textContent=cjBasics.lang.i18n("cj_i18n_06327","Saving"),k.src="about:blank",e={listId:"_bm_choose_list"!==o&&o||null,title:c.cjceValue,webPageUrl:l.cjceValue},n=[null,null,e.title||null,null,null,null,null,null,[e.webPageUrl||null]],f("AddItems",{fields:"listItems/title"},[null,e.listId?[e.listId]:[null,2,[5]],[n]]).then(function(){m=!0,k.src=g+"&",t.remove()})}})),a=(n.cjceAppendChild(r),e&&e.title),n=(a&&(c.cjceValue=a),e&&e.bkmk);n&&(l.cjceValue=n),s.appendChild(t),setTimeout(function(){c.cjceSelect()})}var S,k=cjce.createElement("bm-iframe",{src:g,solid:!0,shadow:!0,onLoad:function(){m&&(m=!1,h.cjceSetLoading(!1))},onBmMessage:function(e,n){var t,a,i,c,l;"interestswithwebappUpdatePath"===e?(c=-1!==(t=n).indexOf("new-list")||-1!==t.indexOf("new-collection"),a=-1!==t.indexOf("/list/"),h.cjceSetBackState(c||a),i="home",t.startsWith("/interests/liked")?i="liked":t.startsWith("/interests/followed")?i="followed":c?i="new-collection":a&&(i=t.split("/list/")[1].split("/")[0]),p.cjceSelectedId=i,c?l=cjBasics.lang.i18n("cj_i18n_06321","New collection"):a?l=(t=j&&p.cjceGetItemElement(i))&&t.textContent||cjBasics.lang.i18n("cj_i18n_06322","Collection"):(l=r,"liked"!==i&&"followed"!==i||(a=_[i])&&(l=a.label)),E.hidden="liked"===i||"followed"===i||c,h.cjceSetPageLabel(l)):"bmCstOpenUrl"===e&&(a=(t=_slicedToArray(n,3))[0],i=t[1],c=t[2],l=cjBasics.cleanBmUrl(a),d.openTab(l,i,c))}}),T=(s.appendChild(k),cjce.createElement("ccbm-fab",{mini:!0,color:!0,iconName:"__mdi_gm:add_link",label:cjBasics.lang.i18n("cj_i18n_06323","Save this"),onClick:function(){B({bkmk:S.url,title:S.title})}})),E=(cjBasics.navigator.getActionableUrl().then(function(e){e?(S=e,T.title=cjBasics.lang.i18n("cj_i18n_06323","Save this")+" ("+S.url+")"):T.parentNode.remove()}),cjce.createElement("ccbm-fabgroup",{items:[cjce.createElement("gmd-fab",{label:cjBasics.lang.i18n("cj_i18n_07429","Create collection"),onClick:function(){k.cjceSendFrameCommand({method:"bmCstClickDomElement",value:'button[jsaction]:has(path[d="M20 13h-7v7h-2v-7H4v-2h7V4h2v7h7v2z"]),a[href*="/new-collection"]'},a),E.hidden=!0,setTimeout(function(){E.hidden=!1},4e3)},onMetaClick:function(){d.openTab(t+"saved/new-collection"+l)}}),cjce.createElement("ccbm-fab",{mini:!0,color:!0,iconName:"__mdi_gm:bookmark_add",label:cjBasics.lang.i18n("cj_i18n_06324","Save new item"),onClick:function(){B()}}),T]}));s.appendChild(E),d.setOnPageDisplayHandler(function(e){e=e.listId;e&&u(e,!0)})});