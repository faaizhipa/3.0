"use strict";!function(){var s=window,o=s.location,r=document,n="undefined"!=typeof chrome&&chrome||{},a=n.runtime.getURL("PATH/").replace("/PATH/",""),i=a.startsWith("safari-web-extension://"),c=!i&&a.startsWith("moz-extension://");var e,t,u,d;"undefined"!=typeof KeyboardEvent&&"key"in KeyboardEvent.prototype&&!/MSIE |Edge\/|Trident.*rv:11\./.test(navigator.userAgent)&&String.quote;function m(e,t,n){s.parent.postMessage({bm_method:e,bm_request:n,bm_value:t},a)}function f(e,t,n){m("cjgOriginRequest",{success:n,response:t},e)}e=function(e){var t;return("https://www.google.com"===e||"https://ogs.google.com"===e||"https://news.google.com"===e)&&(e=o.pathname,i?e.startsWith("/images/cjg-proxy/"):(t=function(){var e;try{e=n.i18n.getMessage("@@extension_id")}catch(e){}return e||a.split("://")[1]}(),e.startsWith("/images/cjg-proxy/"+t)))},t=function(){var n;n=function(e,t,n){var r,a,i,c;"cjgOriginRequest"===e&&(e=JSON.parse(s.atob(t)),r=e.url,i=(a=e.parameters||{}).fetchAs||"text",c=a.method||"GET",("undefined"==typeof XMLHttpRequest?fetch(r,{method:c,body:a.body}).then(function(e){var t=e.status;return t<200||299<t?e.text().then(function(e){throw{status:t,body:e}}):"json"===i?e.json():e.text()}):new Promise(function(n,s){var o=new XMLHttpRequest;o.open(c,r),o.addEventListener("load",function(){var e=o.status,t=o.responseText;if(e<200||299<e)s({status:e,body:t});else if("json"===i)try{n(JSON.parse(t))}catch(e){s(e)}else"xml"===i||"html"===i?(e="xml"===i?"text/xml":"text/html",n((new DOMParser).parseFromString(t,e))):n(t)}),o.addEventListener("error",function(){var e=o.status,t=o.responseText;s({status:e,body:t})}),a.credentials&&"include"===a.credentials&&(o.withCredentials=!0),a.headers&&Object.keys(a.headers).forEach(function(e){var t=a.headers[e];null!=t&&o.setRequestHeader(e,t)}),"json"===i&&o.overrideMimeType("application/json"),o.send(a.body)})).then(function(e){f(n,e,!0)},function(e){f(n,e,!1)}))},s.addEventListener("message",function(e){var t;if(i){if(!e.origin.toLowerCase().startsWith("safari-web-extension://"))return}else if(!(e.origin===a))return;(e.isTrusted||c)&&e.source===s.parent&&(t=(e=e.data||{}).bm_method)&&n(t,e.bm_value,e.bm_request)}),m("cjgProxyReady")},function(e){var t,n;if(s.top!==s.self&&!(r.documentElement instanceof SVGSVGElement))return"object"!=typeof(t=o.ancestorOrigins)?1:(n=i?a.toLowerCase():a,1===t.length?t[0]===n:e&&2===t.length&&t[1]===n&&!t[0].endsWith(".google.com"))}(u)&&(d=(d=(u=o.search).match(/[&?]bm_cid=([\da-z-]{2,25})(?:&|$)/))&&d[1],e(origin,d,u))&&(d&&(r.documentElement.dataset.bmCid=d),t())}();