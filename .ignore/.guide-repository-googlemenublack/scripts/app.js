"use strict";!function(){var l=window,T=l.location,u=document,c="undefined"!=typeof chrome&&chrome||{},R=Object.defineProperty,e=c.runtime.getURL("PATH/").replace("/PATH/",""),i=e.startsWith("safari-web-extension://"),s=!i&&e.startsWith("moz-extension://"),M=!i&&!s,o=c.tabs&&c.tabs.TAB_ID_NONE||-1;function U(r){return new Promise(function(n,a){c.tabs.query(r,function(e){var t=c.runtime.lastError;t?a(t):Array.isArray(e)?i&&r&&r.url?(t=e.filter(function(e){return e.url}),n(t)):n(e):a(new Error("No array returned"))}),setTimeout(n,2e3)})}function W(r){var i,s,e,t;return r&&"string"==typeof r?(i=-1===r.indexOf("?"),s=-1===r.indexOf("#"),e=r.split("?")[0].split("#")[0]+"*",t={currentWindow:!0},(e=e)&&(t.url=e),U(t).then(function(e){for(var t=e.length-1;0<=t;t--){var n=e[t],a=(a=n)&&(a.pendingUrl||a.url)||"";if(a){if(a===r)return n;try{a=new URL(a)}catch(e){continue}if(i&&(a.search=""),s&&(a.hash=""),a.href===r)return n}}return null},function(){return null})):Promise.resolve(null)}function d(e){return"number"==typeof(e=e&&e.id)?e:o}function a(e,t){return new Promise(function(n,a){c.tabs.update(e,t,function(e){var t=c.runtime.lastError;t?a(t):n(e)})})}function H(i){return new Promise(function(n,a){function r(e){var t=e.message||"";"openerTabId"in i&&-1!==t.indexOf("openerTabId")?(delete i.openerTabId,n(H(i))):M&&-1!==t.indexOf("Saved groups are not editable")?n():a(e)}try{c.tabs.create(i,function(e){var t=c.runtime.lastError;t?r(t):n(e)})}catch(e){r(e)}})}function N(e){l.open(e,"_blank","noopener")}function z(t){try{l.top.location.href=t}catch(e){N(t)}}function F(t,e){var n="number"==typeof(e=e)&&e!==o?e:null;return a(n,{url:t}).catch(function(){if(null===n)return U({active:!0,currentWindow:!0}).then(function(e){return e[0]},function(){return null}).then(function(e){e=d(e);if(e!==o)return F(t,e);z(t)});z(t)})}function G(e,t,n,i){var a={url:e},s=(!1===t&&n&&(a.active=!1),d(i));return s!==o&&(a.openerTabId=s,a.index=i.index+1),H(a).then(function(e){var t,n,a,r;return s!==o&&(t=e,n=i,c.tabs.group)&&(a=d(t))!==o&&(r=n.groupId,t.groupId!==r)&&c.tabs.group({groupId:r,tabIds:a},function(){c.runtime.lastError||(t.groupId=r)}),e},function(){N(e)})}function $(e,t,n,a,r){if(!e)return Promise.reject(new Error("Missing URL"));if(!n){var i;if(t)return i=Boolean(a&&a.incognito),s={incognito:i,url:e},new Promise(function(n,a){c.windows.create(s,function(e){var t=c.runtime.lastError;t?a(t):n(e)})}).catch(function(){return G(e,t,n,a)});if(!1===n)return F(e,r)}var s;return G(e,t,n,a)}var V,J="rtl",K="ltr",Q=!0;try{var t=c.i18n.getMessage("@@ui_locale");"string"==typeof t&&"und"!==t&&(V=t.replace("_","-"))}catch(e){Q=!1}var n=V;if(!n)try{var X=c.runtime.getManifest().default_locale;"string"==typeof X&&(n=X.replace("_","-"))}catch(e){}function Y(){var e=Q&&c.i18n.getMessage("@@bidi_dir");return e===J||e===K?e:"string"==typeof(e=n)&&/^(?:ar|apc|afb|prs|ajp|arz|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|uzs|yi|.*[_-](?:adlm|arab|hebr|nkoo|rohg|thaa)(?:$|-|_))(?!.*[_-](?:latn|cyrl)(?:$|-|_))/i.test(e)?J:K}var Z="sync",ee="local",te="get",ne="set",ae="clear",re="getBytesInUse",ie=null,se="__sync_storage__",oe="__sync_fallback__",ce="_local",le=c.storage;function f(e,s,o){return new Promise(function(n,a){function t(e,t){s===te?n(e||{}):(t=t||c.runtime.lastError||s===re&&"number"!=typeof e&&new Error("Received invalid value"))?a(t):n(e)}var r=le[e],i=o||ie;try{s===ae?r[s](t):r[s](i,t)}catch(e){(s===ae?r[s]():r[s](i)).then(t,function(e){t(ie,e)})}})}function ue(e,t,n){var a={};return a[t]=n,f(e,ne,a)}function de(t,n){ue(Z,t,n).catch(function(){var e={};return e[se+t]=n,e[oe]=!0,f(ee,ne,e)})}var fe,r,p,m,pe,me,ge={},g=(!function(e,t){for(var n in t)R(e,n,{get:t[n],enumerable:!0})}(ge,{add:function(){return xe},contains:function(){return Pe},getDefaultServices:function(){return qe},getLastUsed:function(){return Oe},getLastUsedNonToolsPage:function(){return Ee},init:function(){return we},onChange:function(){return Le},remove:function(){return je},replace:function(){return Ie},set:function(){return y},setLastUsed:function(){return Ae}}),[]),h=[],he=[],b=["search","maps","translate","news","youtube","gmail","calendar","drive","keep","tasks"],be=["youtube","ytstudio","mybusiness","photos","contacts","save","myaccount","passwords","myactivity","myadcenter"],ve=["accountchooser","contentblocking","customize","missingpermissions","newtab","portal","pagestateupdate","notifications","removedialog"],ye=["applauncher","extensionsettings"],_e={"keep-pro":"keep",keeplite:"keep",shoppinglist:"keep",music:"ytmusic",playmusic:"ytmusic",podcasts:"ytmusic",tiltbrushsketches:"poly",vrblocks:"poly",trackedflightprices:"flights",destinations:"googletravel",flightsandhotels:"googletravel",flightshotels:"googletravel",packages:"googletravel",travelpackages:"googletravel",trips:"googletravel",vacations:"googletravel",googlepay:"wallet",gpay:"wallet",payments:"paymentscenter",bard:"gemini",generatedimages:"gemini",chromeapps:"browserapps",chromebookmarks:"browserbookmarks",chrometopsites:"browsertopsites",adwords:"ads",appmaker:"script",calendarlite:"calendar",duo:"meet",duowithwebapp:"meet",duowithlinks:"meet",express:"shopping",gmaillite:"gmail",gplus:"currents",hangouts:"chat",publicalerts:"covid19",shortlists:"save",webmastertools:"searchconsole",atari:"sites"},v={};function ke(a){g=[],h=[],Object.keys(v).forEach(function(e){var t=-1!==a.indexOf(e),n=v[e].hidden;(!n||t&&"unused"===n)&&(t?g:h).push(e)}),g=g.sort(function(e,t){return a.indexOf(e)<a.indexOf(t)?-1:1}),h=h.sort(function(e,t){return v[e].label<v[t].label?-1:1})}function we(e){he=[],me=new Promise(function(e){pe=e}),v=e.servicesDatabase||{};e=Promise.all([e.mainStorageRequest,e.servicesDatabaseRequest,e.accountRequest]).then(function(e){var t=e[0].bm_pref__portal__lastused,t=_e[t]||t,n=e[0].bm_pref__portal__services||b;if(v=e[1],fe=e[2],m=t||n[0],r=p=m,fe.pageId)return-1===(g=Object.keys(v).filter(function(e){return v[e].brandAccount&&!v[e].hidden}).sort(function(e,t){return be.indexOf(e)-be.indexOf(t)})).indexOf(r)&&(r="aboutme"),null;Array.isArray(n)?(e=n.join(" "),Object.keys(_e).forEach(function(e){var t=n.indexOf(e);-1!==t&&(n[t]=_e[e])}),ke(n),e!==g.join(" ")&&de("bm_pref__portal__services",g)):(r=t||b[0],ke(b))});pe(e)}function y(e){ke(e),de("bm_pref__portal__services",g),he.forEach(function(e){e(g,h)})}function Pe(e){return-1!==g.indexOf(e)}function je(e,t){t=t||g.indexOf(e);-1!==t&&(g.splice(t,1),y(g))}function Ie(e,t){var n,a;-1!==h.indexOf(t)&&-1!==(n=g.indexOf(e))&&(-1===(a=g.indexOf(t))?(g[n]=t,y(g)):je(e,a))}function xe(e){y(g.concat(e))}function Le(e){var t;he.push(e),t=e,me.then(function(){t(g,h)})}function Oe(){return me.then(function(){return 0<g.length?{serviceId:p}:{serviceId:"customize",sessionParameters:{welcome:!0}}})}function Ee(){return m}function Ae(e){r=e,-1===ve.indexOf(e)&&(p=e,-1===ye.indexOf(e))&&(m=e),ue(ee,"bm_pref__portal__lastused",p)}function qe(){return b}var _,k,w,P,Be,j,De,Ce,Se,e=new URLSearchParams(T.search),I=u.documentElement,Te=!1,x=!1,L=[],O=e.get("page"),E=e.get("environment"),t=T.pathname,Re=(t.endsWith("/popup.html")?E=cjBasics.navigator.isFirefoxMobile?"compact":"popup":t.endsWith("/newtab.html")?E="newtab":t.endsWith("/sidebar.html")?E="sidebar":t.endsWith("/options.html")?(O="extensionsettings",E="options"):cjBasics.navigator.isFirefoxMobile&&(E="compact"),"compact"===E||"sidebar"===E),A=(Re&&!O&&(O="portal"),cjBasics.pages),Me=!1,q=cjgApis.account.missingAccountData,Ue="";function B(e){return q=e,Ue=cjgFrontend.urls.createWizPath(q),q}var D=cjgApis.session.init(B).then(B);function C(e,t,n){return $(e,t,n).then(function(){"popup"!==E||n&&!1===t||l.close()})}function We(t,e,n){return t?e||n?C(t,e,n):"newtab"===E?a(null,{active:!0,url:t}).catch(function(){return C(t)}):W(t).then(function(e){e=d(e);return e===o?C(t):a(e,{active:!0}).catch(function(){return C(t)})}):Promise.resolve()}var He,S=function(){var o=[],c=O||"search",l=!1;return{navigate:function e(t,n){if(n&&n.softInit){if(l)return}else l=!0;var a,r,i=A[t];function s(){t===c&&i.onPageDisplayHandler(n||{})}i&&i.linkOnly?e(i.pageId,i.pageParameters||n):(i&&-1===L.indexOf(t)&&Fe(t),a=c=t,r=k.querySelector(":scope > .selected"),a!==(r&&r.dataset.id||null)&&(a=k.querySelector(':scope > [data-id="'+a+'"]'),r&&r.classList.remove("selected"),a)&&a.classList.add("selected"),o.forEach(function(e){e(c)}),O||Ae(c),i&&(i.onPageDisplayHandler?s():i.lastPageDisplayCallback=s))},onChange:function(e){o.push(e),e(c)},restore:function(){l=!1,o=[]}}}();function Ne(e){var t=(e=e||{}).serviceData||{},n=O&&!Re;return{missingGooglePermission:Me,instanceParameters:e.instanceParameters||{},darkMode:t.preferDarkMode?!Te:x,setOnPageDisplayHandler:e.setOnPageDisplayHandler,account:q,wizPath:Ue,openTab:We,requirePage:ze,loadPage:Fe,environment:E,standaloneService:O,pageManager:S,userServices:ge,servicesDatabase:A,ogbShowAccount:n}}function ze(e){var t=A[e]||{},n=t.loadPromise;if(!n){var a="/pages/"+e+"/index.js",r=[w,j,D],i=("portal"!==e&&r.push(Be,Se,Ce),t.preload||[]),s=(t.pageId&&t.pageId!==e?i.push(t.pageId):r.push(cjBasics.loadScript(a)),t.extraCss&&r.push(cjBasics.loadStyle("/pages/"+e+"/index.css")),t.dnsPrefetch);if(s)for(var o=0;o<s.length;o++){var c=u.createElement("link");c.rel="dns-prefetch",c.href=s[o],u.head.appendChild(c)}Array.isArray(i)&&l.requestIdleCallback&&l.requestIdleCallback(function(){i.forEach(ze)},{timeout:2e3}),Array.isArray(t.dependencies)&&t.dependencies.forEach(function(e){r.push(ze(e))}),n=Promise.all(r),t.loadPromise=n}return n}function Fe(e){L.push(e);var t=A[e],n=t.pageId||e,a=t.pageParameters,r=!cjBasics.webRequest.getWrifSupported()&&t.wrifFallbackPageId,r=(r&&(A[r]?n=r:(n="pagestateupdate",a={productId:e})),s&&t.firefoxFallbackPageId),r=A[n=r?r:n];Me&&!r.noGooglePermissionNeeded?(n="pagestateupdate",a={productId:e,missingPermissions:!0}):"valid"===r.requireSignin&&cjBasics.webRequest.getHasFirefoxContentBlocking()?(n="pagestateupdate",a={productId:e,contentBlocking:!0}):!q.validSession&&r.requireSignin?(n="pagestateupdate",a={productId:e,signinRequired:!0}):!q.pageId||t.brandAccount&&r.brandAccount||(n="pagestateupdate",a={productId:e,brandAccountUnsupported:!0});r=Ne({serviceData:t,setOnPageDisplayHandler:function(e){t.onPageDisplayHandler=e,setTimeout(function(){"function"==typeof t.lastPageDisplayCallback&&t.lastPageDisplayCallback(),t.lastPageDisplayCallback=null})},instanceParameters:a}),a=cjce.createElement("bm-app",{bmApis:r,pageId:n});a.dataset.id=e,k.appendChild(a)}function Ge(){var r=matchMedia("(prefers-color-scheme: dark)");(x=r.matches)&&I.classList.add("bm-style-flag--dark"),r.addEventListener&&r.addEventListener("change",function(){x=r.matches,I.classList.toggle("bm-style-flag--dark",x);for(var e=k.children,t=0;t<e.length;t++){var n=e[t],a=n.dataset.id;A[a].preferDarkMode||n.classList.toggle("cjmd--dark",x)}})}function $e(e){var t=u.querySelector('meta[name="color-scheme"]');t&&(t.content="light"===(t=e)?"light only":"dark"===t?"dark only":"light dark")}function Ve(){u.body.textContent="",(_=u.createElement("div")).className="bm-ele-main",u.body.appendChild(_),P=function(e){var t=f(Z,te,e),n=e;if(e)for(var n=e.slice(),a=0;a<e.length;a++)n.push(se+e[a]);var r=f(ee,te,n);return t.then(function(s){return r.then(function(e){for(var t=s,n=Object.keys(s),a=Object.keys(e),r=0;r<a.length;r++){var i=a[r];n.includes(i)||(t[i]=e[se+i]||e[i])}return t[ce]=e,t})})}(["bm_pref__main__theme","bm_pref__main__language","bm_pref__webrequestcheck__wrifissue","bm_pref__portal__services","bm_pref__portal__lastused"]),De=P.then(function(e){e=e.bm_pref__main__language;if(e)return cjBasics.lang.overrideLanguage(e)}),w=De.then(function(){return A=cjBasics.pages,Object.keys(A).forEach(function(e){var t=A[e].labelI18n;t&&(A[e].label=cjBasics.lang.i18n(t,A[e].label))}),cjBasics.isUsaCheck()&&(A.movies.color=!0,A.movies.iconName="tv",A.movies.label=cjBasics.lang.i18n("cj_i18n_06402","Google TV")),A}),Be=cjBasics.webRequest.restoreWrifSupported(P),j="options"===E?(Ge(),$e(),Promise.resolve()):P.then(function(e){e=e.bm_pref__main__theme;"light"===e?(Te=!0,I.classList.add("bm-style-flag--light"),I.classList.remove("bm-style-flag--dark")):"dark"===e?(x=!0,I.classList.remove("bm-style-flag--light"),I.classList.add("bm-style-flag--dark")):Ge(),$e(e)}),0<L.length&&(L=[],S.restore(),cjgApis.session.resetCache(),D=cjgApis.session.init(B).then(B)),we({mainStorageRequest:P,accountRequest:D,servicesDatabaseRequest:w}),c.runtime.onMessage.addListener(function(e,t){return t.id===c.runtime.id&&"reloadAllInstances"===(e&&e.method)&&cjBasics.reloadSelf(),!1});var t,n,e=!O;e&&((t=u.createElement("div")).className="bm-ele-mainportal",n="portal","newtab"===E?(n="newtab",t.classList.add("bm-ele-mainportal--newtab")):t.classList.add("bm-ele-mainportal--sideportal"),_.appendChild(t),Promise.all([w,j]).then(function(){var e=A[n],e=cjce.createElement("bm-app",{pageId:n,bmApis:Ne({serviceData:e})});t.appendChild(e)})),e=e,(k=u.createElement("div")).className="bm-ele-mainwindow","newtab"===E?k.classList.add("bm-ele-mainwindow--newtab"):e&&k.classList.add("bm-ele-mainwindow--sideportal"),_.appendChild(k),setTimeout(function(){I.classList.add("bm-style-flag--loaded")},10),Se=("object"!=typeof c.permissions?Promise.resolve(!0):new Promise(function(e){c.permissions.contains({origins:["https://*.google.com/*","https://*.google.com/cjg-auth/*"]},e)})).then(function(e){Me=!e}),Ce=cjBasics.navigator.getCurrentTabIdRequest(),Promise.all([w,D,Be,Se,j]).then(function(){O?S.navigate(O,{softInit:!0}):Oe().then(function(e){var t=e.sessionParameters||{};t.softInit=!0,S.navigate(e.serviceId,t)})},function(e){})}Re?I.classList.add("bm-style-flag--compact"):O&&I.classList.add("bm-style-flag--singlepage"),s&&I.classList.add("bm-style-flag--firefox"),"popup"!==E&&"options"!==E||(I.classList.add("bm-style-flag--no-cloak"),"popup"===E?(cjBasics.navigator.isMac&&setTimeout(function(){c.runtime.sendMessage({method:"closeAuthPopup"})},100),(s||cjBasics.navigator.isMac&&!i)&&(He=1600,function e(){I.classList.add("bm-style-flag--macfix"),setTimeout(function(){I.classList.remove("bm-style-flag--macfix")},20),0<He&&(setTimeout(e,500),He-=500)}())):"options"===E&&I.classList.add("bm-style-flag--options")),u.documentElement.dir=Y(),u.documentElement.lang=n,"popup"===E||"options"===E?"complete"===u.readyState?setTimeout(Ve,100):l.addEventListener("load",function(){setTimeout(Ve,100)}):Ve()}();