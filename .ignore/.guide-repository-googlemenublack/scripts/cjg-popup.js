"use strict";!function(){var a=window,i=a.location,s=document,o="undefined"!=typeof chrome&&chrome||{},r=o.runtime.getURL("PATH/").replace("/PATH/",""),c=r.startsWith("safari-web-extension://");c||r.startsWith("moz-extension://");"undefined"!=typeof KeyboardEvent&&"key"in KeyboardEvent.prototype&&!/MSIE |Edge\/|Trident.*rv:11\./.test(navigator.userAgent)&&String.quote;var e="rtl",n="ltr",u=!0;try{var t=o.i18n.getMessage("@@ui_locale");"string"==typeof t&&"und"!==t&&(l=t.replace("_","-"))}catch(t){u=!1}var g,l,h=l;if(!h)try{var p=o.runtime.getManifest().default_locale;"string"==typeof p&&(h=p.replace("_","-"))}catch(t){}function f(){var t=u&&o.i18n.getMessage("@@bidi_dir");return t===e||t===n?t:"string"==typeof(t=h)&&/^(?:ar|apc|afb|prs|ajp|arz|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|uzs|yi|.*[_-](?:adlm|arab|hebr|nkoo|rohg|thaa)(?:$|-|_))(?!.*[_-](?:latn|cyrl)(?:$|-|_))/i.test(t)?e:n}function d(){g||o.runtime.sendMessage({method:"closeAuthPopup"})}function m(){o.runtime.sendMessage({method:"reloadAllInstances"},d)}function v(t){cjgApis.session.changeAccount(t,!0).then(m,m),setTimeout(m,1e3)}function A(e){cjgApis.account.list({listPages:!1}).then(function(t){Array.isArray(t)?0!==t.length&&t[0].validSession?v(function(t,e){for(var n=t[0],a=0;a<t.length;a++){var i=t[a];if(i.validSession){if(i.authuser===e)return i;i.authuser>n.authuser&&(n=i)}}return n}(t,e)):v(cjgApis.account.noAccountData):v(cjgApis.account.missingAccountData)})}function y(t,e){Promise.all([cjgApis.account.list({targetAuthuser:e}),cjgApis.auth.getTokenInfo(t)]).then(function(t){t=function(t,e){for(var n=0;n<t.length;n++){var a=t[n];if(a.obfuscatedId===e)return a}return null}(t[0],t[1].sub);t?v(t):m()},m)}function b(){var t=i.href,e=(t.match(/authuser=(\d)/)||[])[1]||null,t=(t.split("access_token=")[1]||"").split("&")[0],n=(i.hash||"").split("--macpopup"),n=(g=n[1]&&cjBasics.navigator.isMac&&!cjBasics.navigator.isOpera,n[0].replace("#","")),a=i.pathname.split("/")[3];"signin"===a||"signin"===n?A(e):("signout"!==a&&"signout"!==n||v(cjgApis.account.noAccountData),t?y(t,e):(g?m:d)())}function j(){var t,e,n=i.href;o.runtime.sendMessage({data:n,method:"cjgAuthUrl"}),c&&(t="cjgAuthUrl",a.parent.postMessage({bm_method:t,bm_request:e,bm_value:n},r))}(t=s.documentElement).dir=f(),t.lang=h,(s.body||t).textContent="",t=i.origin,l=i.pathname,(p=a.top===a.self)&&t===r&&"/views/cjg-popup.html"===l?b():"https://www.google.com"===t&&(t=l.match(/^\/(?:images\/)?cjg-(auth|apis)\/(.+)/))&&(l=t[1])&&(c||t[2]===function(){var t;try{t=o.i18n.getMessage("@@extension_id")}catch(t){}return t||r.split("://")[1]}())&&(p?b():"auth"===l&&function(t){var e,n;if(a.top!==a.self&&!(s.documentElement instanceof SVGSVGElement))return"object"!=typeof(e=i.ancestorOrigins)?1:(n=c?r.toLowerCase():r,1===e.length?e[0]===n:t&&2===e.length&&e[1]===n&&!e[0].endsWith(".google.com"))}()&&j())}();